# WrongWayEnforcer

## Назначение

WrongWayEnforcer следит за направлением движения автомобиля относительно активного сегмента трассы и мягко разворачивает игрока, если он едет в обратную сторону. Скрипт требует компоненты LapTracker и Rigidbody на том же объекте.

## Логика работы

В FixedUpdate сравнивается направление горизонтальной скорости машины с направлением текущего сегмента, которое предоставляет LapTracker через GetSegmentDir. Если машина достаточно быстрая и косинус угла между векторами меньше порогового значения dotThreshold, начинает тикать таймер wrongTimer. Когда он превышает confirmTime, запускается корутина DoPenalty.

Корутина DoPenalty сначала в течение preRespawnSlowTime постепенно затухает скорость (Lerp к нулю без резкого стопа), а затем просит LapTracker вернуть машину на последнюю корректно пройденную точку через RespawnToLastCheckpoint.

## Параметры детектора

| Параметр           | Описание                                                                                                  |
| ------------------ | --------------------------------------------------------------------------------------------------------- |
| dotThreshold       | Порог косинуса между направлением скорости и сегментом трассы; значения ниже считают машину едущей назад. |
| minSpeed           | Минимальная скорость, ниже которой движение игнорируется и таймер сбрасывается.                           |
| confirmTime        | Время, которое нужно ехать “назад”, прежде чем будет вызвано наказание.                                   |
| preRespawnSlowTime | Интервал мягкого замедления перед телепортом на чекпоинт.                                                 |

## Рекомендации по использованию

- Навесьте скрипт на тот же объект, где уже есть LapTracker и физическая машина.
- Подберите dotThreshold так, чтобы кратковременные рыскания не воспринимались как езда в обратную сторону.
- Увеличьте confirmTime, если хотите более “прощающее” поведение при разворотах и развесёлых дрифтовых манёврах.
