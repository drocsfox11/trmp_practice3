# TrackRibbon

## Общее описание

TrackRibbon описывает геометрию дорожного полотна через два ряда опорных точек: левую и правую кромку. Скрипт помечен ExecuteAlways, поэтому пересчёт ленты происходит как в режиме редактирования, так и в Play.

## Структура данных

- leftEdgeRoot и rightEdgeRoot — родительские объекты, чьи дочерние трансформы задают опорные точки левой и правой кромки.
- В методе Rebuild собираются списки left, right и вычисляются точки center как середина между левой и правой кромкой.
- По массиву center считается cumulative длина prefix и общее значение totalLen.

## Функция Evaluate

Evaluate(float s, float lateral) интерполирует вдоль массива center по дуговой длине s (с повторением по кругу) и возвращает:

- pos — мировую позицию точки на дороге;
- dir — сглаженное направление движения вдоль трассы, проецируемое на горизонтальную плоскость;
- halfWidth — половину ширины дороги в этой точке.

Параметр lateral задаётся в диапазоне от −1 до +1 и определяет смещение между левой и правой кромкой (−1 — у левого борта, 0 — центр, +1 — у правого).

## Визуализация

![Gizmos ленты трассы](../images/track_ribbon_gizmos.png)

OnDrawGizmos рисует:

- бирюзовую линию по центру трассы (массив center);
- красные сферы вдоль левой кромки;
- зелёные сферы вдоль правой кромки, что помогает визуально проверять форму и ширину дороги при редактировании.
